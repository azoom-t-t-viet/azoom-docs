## 概要

[lerna/lerna: A tool for managing JavaScript projects with multiple packages](https://lerna.js.org).

が何ものかというと、単一のリポジトリで複数の npm module 開発を可能にするツールです。



## 活用手順

1. `lerna`をインストール

```cmd
$ yarn global add lerna
```

2. 既存プロジェクトに活用

```cmd
$ cd project
$ lerna init
```

project構築

```
project/
  packages/
      package1/
      package2/
      ...
  package.json
  lerna.json
```

`lerna.json`の中に、lernaの設定オプションを設定して、

```
{
  "version": "1.1.3",        # 共通のバージョン
  "packages": [              
    "packages/*"             # パクージのロカールのパクージパス
  ],
  "useWorkspaces": true
}
```

packagesの各サブフォルダーの中に、package.jsonを追加します。

例） パクージ1の`package.json`ファイル内容

```
{
  "name": "package1",            # パクージ名
  "version": "1.0.0",            # パクージのバージョン
  "privite": true,
  "dependencies": {    　　　　　　＃ 依存のパクージ
    "rsmdc-card": "^1.0.0",
    "rsmdc-button": "~2.2.0"
  }
}
```

パクージ一覧を確認用のコマンド
```cmd
$ lerna ls -l
```

全てパクージをリンクして、依存関係を追加するためのコマンド
```cmd
$ lerna bootstrap
```

3. パクージのmoduleを追加

共通のプロジェクトあるいは各パクージのmoduleの管理

4. リリース

以下のコマンドを実行します。

```cmd
$ lerna publish
```
このコマンドを実行したら、共通のバージョン（`lerna.json`の`version`値）が指定出来ます。

更新されたパクージのバージョンも指定出来ます。

例）　現在の共通バージョンは`1.1.3`の場合、`lerna publish`の実行後、

```
lerna.json
    version: 1.1.3    →　 1.1.4
package1 (更新あり)
    version: 1.0.0    →　 1.0.1
package2 (更新なし)
    version: 1.0.0 (そのまま)
```
になります。

バージョンが更新れれた後、`Github`に最新コードがプッシュ出来ます。

リリースが完了です。


5. パクージを更新

一つあるいは複数のパクージの更新ある場合

* パクージのソースコードを更新します。

* 上記の`4`のリリースコマンドを実行します。
